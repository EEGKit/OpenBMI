function sequence = createSequence(N),

posSer = [1, 3, 5, 2, 4; ...
          1, 4, 2, 5, 3; ...
          2, 4, 1, 3, 5; ...
          2, 4, 1, 5, 3; ...
          2, 5, 3, 1, 4; ...
          3, 1, 4, 2, 5; ...
          3, 5, 2, 4, 1; ...
          3, 5, 1, 4, 2; ...
          3, 1, 5, 2, 4; ...
          4, 2, 5, 3, 1; ...
          4, 2, 5, 1, 3; ...
          4, 1, 3, 5, 2; ...
          5, 3, 1, 4, 2; ...
          5, 2, 4, 1, 3];
              
posConn = [  6,  7,  8,  9, 13, 14; ...
             3,  4,  5, 10, 11, 12; ...
             1,  2,  4, 10, 11, 12; ...
             2,  3,  5, 10, 11, 12; ...
             6,  7,  8,  9, 13, 14; ...
             1,  2,  9, 10, 11, 12; ...
             3,  4,  5,  8, 13, 14; ...
             1,  2,  6,  7,  9, 13; ...
             1,  6,  7,  8, 13, 14; ...
             3,  4,  5, 11, 13, 14; ...
             3,  4,  5, 10, 12, 14; ...
             1,  2,  6,  7,  8,  9; ...
             1,  2,  6,  7,  8,  9; ...
             3,  4,  5, 10, 11, 12];
                     
initSeq = randperm(14);
initSeq = initSeq(1);
seqIdx = [initSeq];
sequence = [posSer(initSeq, :)];

if N > 1, 
    for i = 1:N-1,
        idx = randperm(6);
        seqIdx = [seqIdx posConn(seqIdx(i), idx(1))];
        sequence = [sequence posSer(posConn(seqIdx(i), idx(1)), :)];
    end
end

%% hack for right speaker
sequence = sequence - 2;
sequence(find(sequence == -1)) = 7;
sequence(find(sequence == 0)) = 8;

                     
end